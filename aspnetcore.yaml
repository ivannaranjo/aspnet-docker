# Build script to transform a .NET Core app's sources into a Docker
# image to be deployed to Google App Engine Flex.
steps:
- name: 'gcr.io/aspnetcore-staging/aspnetcorebuild:latest'
  args:
    - '--version-map'
    - '1.0.8=gcr.io/google-appengine/aspnetcore:1.0.8'
    - '1.1.5=gcr.io/google-appengine/aspnetcore:1.1.5'
    - '2.0.4=gcr.io/google-appengine/aspnetcore:2.0.4'
    - '--supported-sdks'
    - '1.0.0-preview2-003156'
    - '1.1.5'
    - '2.1.3'
- name: gcr.io/cloud-builders/docker:latest
  args: [ 'build', '-t', '$_OUTPUT_IMAGE', '--no-cache', '--pull', '.' ]

images:
  ['$_OUTPUT_IMAGE']
